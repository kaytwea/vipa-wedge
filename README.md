# A model for VIPAs with nonparallel mirrors
These MATLAB scripts (v2018a) encode the model described in [10.1364/AO.570670](https://doi.org/10.1364/AO.570670).  They can compute all fringe pattern data, associated with the computational model, used in the paper.

`run_air_beam.m` allows the user to specify VIPA, optical, and model parameters before running `wedge_v3ab.m`, which is the air-spaced VIPA model for an input beam converging to a physical waist of finite span; output is a set of monochromatic fringe patterns.  Runtime is ~15 minutes on old hardware (Ryzen 5 1600, 3.2 GHz, 16 GB).  
`run_air_point.m` does the same for `wedge_v3ap.m`, which is the air-spaced VIPA model for an input beam converging to an ideal point-sized waist.  Due to a particular feature of the model, computations are greatly simplified, permitting runtimes on the order of a few seconds.  

Note: if computations exceed RAM capacity and trigger virtual memory, runtime is increased considerably.  In such cases, increase the number of domain subdivisions, or reduce other computational parameters.

To download the bundle, click on `Code` (green button top right) and select `Download ZIP`.  To download an individiual file, click on the file, then select `Download raw file` in the upper right of the code viewer; alternatively, copy/paste the code into a MATLAB editor.


## Short background
The virtually-imaged phased array (VIPA) is an etalon with a window that operates as a spectral disperser, like a diffraction grating.  It is typically paired with a lens that images the dispersed spectrum onto an image plane.  As a parallel-plate interferometer, its ideal response to monochromatic input is an Airy fringe pattern.  However, when the VIPA mirrors are not perfectly parallel, nonideal instrument behaviour can arise.

This model computes monochromatic fringe patterns generated by air-spaced VIPAs with nonparallel mirrors, and imaged at specifiable distances from the lens.  As fringe patterns characterize instrument behaviour, model output resolves nonideal VIPA behaviour along the combined dimensions of dispersion axis and image plane distance.  Although the model was developed for air-spaced VIPAs, results are applicable to solid-body VIPAs, and other etalons operated as dispersers.

The model is based on rigorous application of scalar diffraction theory.  Its development was heavily inspired by  
[1] M. Born and E.Wolf, *Principles of Optics*, 6th ed. (Pergamon, 1986).  
[2] J.W. Goodman, *Introduction to Fourier Optics*, 2nd ed. (McGraw-Hill, 1996).  
[3] S. Xiao, A. M. Weiner, and C. Lin, “A dispersion law for virtually imaged phased-array spectral dispersers based on paraxial wave theory,” IEEE J. Quantum Electron. **40**, 420–426 (2004).

## Contact

If you have any questions or issues, you can reach me at *firstname.lastname*@mail.utoronto.ca.  I'm the first author on the paper linked above.
